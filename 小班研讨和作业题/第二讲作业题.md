# ICS小班第二讲作业

姓名：汤伟杰
学号：2400016635

## 2.59

```c
/*
 * 编写一个C表达式，它生成一个字，由 x的最低有效字节和y中剩下的字节组成。
 * Ex: x = 0x89abcdef, y = 0x76543210
 * combByte(x, y) = 0x765432ef
 */
int combByte(x, y) {
    int mask_for_x = 0xff;
    int mask_for_y = ~0xff;
    int lo_x_byte = x & mask_for_x;
    int hi_y_byte = y & mask_for_y;
    return lo_x_byte | hi_y_byte;
}
```

## 2.60

```c
/* 
 * 写出下面C函数的代码，它会返回一个无符号值，其中参数x的字节i被替换成字节b
 * Ex:  replace_byte(0x12345678, 2, OxAB) --> 0x12AB5678
 *      replace_byte(0x12345678, 0, OxAB) --> 0x123456AB
 */
unsigned replace_byte(unsigned x, int i, unsigned char b) {
    // 0 - 0; 1 - 8; 2 - 16; 3 - 24
    int mask = 0xff << (i << 3);
    return (x & ~mask) | (b << (i << 3));
}
```


## 2.71

A. 错在只提取了字节，但是没有扩展符号，得到的结果中高24位都是0。

B.

```c
typedef unsigned packed_t;

int xbyte(packed_t word, int bytenum) {
    // 先左移到最高位，再右移自动补上符号位扩展
    int ans = (word << ((3 - bytenum) << 3));
    return ans >> 24;

    /**** 没有使用减法 ****/
    // int ans = (word >> (bytenum << 3)) & 0xff;
    // int sign = (ans >> 7) & 1;
    // int mask = sign << 31 >> 23;
    // return mask | ans;
}

```